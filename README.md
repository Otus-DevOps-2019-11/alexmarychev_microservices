# alexmarychev_microservices
alexmarychev microservices repository

#HW15

1. Создал виртуальную машину с помощью docker-machine и установил на нее gitlab.

2. Зарегистрировался, создал новую группу и проект в gitlab.

3. Создал файл .gitlab-ci.yml и добавил его в репозиторий.

4. Запустил и зарегистрировал Runner.

5. Добавил исходный код reddit в репозиторий и изменил описание пайплайна в .gitlab-ci.yml. Создал файл simpletest.rb.

6. Добавил библиотеку для тестирования в reddit/Gemfile приложения.

7. Изменил пайплайн таким образом, чтобы job deploy стал определением окружения dev, на которое условно будет выкатываться каждое изменение в коде проекта.

8. Определил два новых этапа: stage и production.

9. Добавил job, который определяет динамическое окружение для каждой ветки в репозитории, кроме ветки master.


#HW16

1. Создал правила файерволла для Prometheus и Puma.

2. Создал Docker хост в GCE и настроил локальное окружение на работу с ним.

3. Запустил систему мониторинга с помощью готового docker-контейнера.

4. Изучил интерфейс Prometheus.

5. Собрал на основе готового образа с DockerHub свой Docker образ с конфигурацией для мониторинга микросервисов.

6. Настроил сборку образов с микросервисами с помощью скриптов docker_build.sh.

7. Изучил мониторинг останавливая и поднимаю сервисы.

8. Настроил Node экспортер для сбора информации о работе Docker хоста.

9. Запушил собранные образы на DockerHub: https://cloud.docker.com/u/alexmarychev/repository/list

#HW17

1. Создал виртуальную машину с помощью docker-machine.

2. Разделили файлы docker compose на файл с приложениями ```docker-compose.yml``` и файл с мониторингом ```docker-compose-monitoring.yml```

3. Добавил сервис cadvisor в ```dockercompose-monitoring.yml``` и в конфиг prometheus. Пересобрал контейнер с prometheus.

4. Добавил сервис grafana в ```docker-compose-monitoring.yml```

5. Импортировал дашборд в grafana.

6. Добавил графики сбора метрик мониторинга приложения UI

7. Добавил в prometheus информацию о приложении post.

8. Создал дашборд в grafana и построил график изменения счетчика HTTP-запросов по времени.

9. Добавил в дашборд график запросов, которые возвращают код ошибки.

10. Использовал для первого графика функцию rate - ```rate(ui_request_count[1m])```

11. Добавил третий график на дашборд для вычисления 95 процентиля времени ответа на запрос.

12. Создал новый дашборд для мониторинга бизнес-логики.

13. Добавил на новый дашборд два графика для подсчета количества постов и комментариев.

14. Добавил алертинг, который срабатывает, если одна из систем становится недоступна.

15. Залил все docker-образы на dockerhub. Они доступны по ссылке: https://hub.docker.com/u/alexmarychev/
